<Workspace Version="0.9.0.3067" X="-234.522841963976" Y="30.0258419922496" zoom="0.874053649550264" Name="ReadExcel" Description="" ID="eaf26e49-8b6f-4afd-8419-0a5b890c58d4" Category="Hot Gear.ExcelToParameter">
  <NamespaceResolutionMap>
    <ClassMap partialName="List" resolvedName="DSCore.List" assemblyName="DSCoreNodes.dll" />
  </NamespaceResolutionMap>
  <Elements>
    <DSCore.File.FileObject guid="c71f7058-9a4b-49fd-b824-bed5c23577ea" type="DSCore.File.FileObject" nickname="File.FromPath" x="302.646320048223" y="0" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" />
    <Dynamo.Nodes.DSFunction guid="9d617795-60c0-448f-86be-766a1ac71481" type="Dynamo.Nodes.DSFunction" nickname="Excel.ReadFromFile" x="250" y="110.828045771213" isVisible="true" isUpstreamVisible="true" lacing="Shortest" isSelectedInput="False" assembly="DSOffice.dll" function="DSOffice.Excel.ReadFromFile@var,string,bool">
      <PortInfo index="2" default="True" />
    </Dynamo.Nodes.DSFunction>
    <Dynamo.Nodes.DSFunction guid="05fb3aa1-be34-459f-8383-79013ba66ac2" type="Dynamo.Nodes.DSFunction" nickname="List.Transpose" x="259.447616308333" y="272.747146831203" isVisible="true" isUpstreamVisible="true" lacing="Shortest" isSelectedInput="False" assembly="DSCoreNodes.dll" function="DSCore.List.Transpose@var[]..[]" />
    <Dynamo.Nodes.CodeBlockNodeModel guid="ccb441ab-1cb9-457b-bfd7-803017949fbb" type="Dynamo.Nodes.CodeBlockNodeModel" nickname="Code Block" x="427.73533212316" y="327.690331178998" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" CodeText="Z=a[0];&#xA;A = List.Count(Z);&#xA;1..A-1;&#xA;0;" ShouldFocus="false" />
    <Dynamo.Nodes.DSFunction guid="ccee52ca-1001-4add-a0b7-23d7554e2c83" type="Dynamo.Nodes.DSFunction" nickname="List.GetItemAtIndex" x="719.74498283584" y="288.793283646705" isVisible="true" isUpstreamVisible="true" lacing="Shortest" isSelectedInput="False" assembly="DSCoreNodes.dll" function="DSCore.List.GetItemAtIndex@var[]..[],int" />
    <Dynamo.Nodes.DSFunction guid="cd08c8d3-50c9-4b4f-afa0-5f896c0e5956" type="Dynamo.Nodes.DSFunction" nickname="List.GetItemAtIndex" x="723.36903158933" y="403.160879813998" isVisible="true" isUpstreamVisible="true" lacing="Shortest" isSelectedInput="False" assembly="DSCoreNodes.dll" function="DSCore.List.GetItemAtIndex@var[]..[],int" />
    <DSCore.Map guid="41595262-82b1-400a-adab-b53c8102c661" type="DSCore.Map" nickname="List.Map" x="922.955474178238" y="282.67845249824" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" />
    <DSCore.Map guid="13b920c3-9746-41c4-b84a-ecaafa3c3332" type="DSCore.Map" nickname="List.Map" x="931.789357921502" y="410.315666801135" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" />
    <Dynamo.Nodes.CodeBlockNodeModel guid="c89f3ab7-274a-49b1-af29-093110eee13f" type="Dynamo.Nodes.CodeBlockNodeModel" nickname="Code Block" x="1150.98549783814" y="196.306442151669" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" CodeText="X[n];&#xA;Y[n];&#xA;Z[0];" ShouldFocus="false" />
    <Dynamo.Nodes.Symbol guid="926481e9-ed90-41f3-a241-576c2f9e75f0" type="Dynamo.Nodes.Symbol" nickname="Input" x="0" y="0" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="True">
      <Symbol value="File Path" />
    </Dynamo.Nodes.Symbol>
    <Dynamo.Nodes.Symbol guid="751d6164-8b6f-4f23-b6d2-84b1fc0e2ec3" type="Dynamo.Nodes.Symbol" nickname="Input" x="0" y="150" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="True">
      <Symbol value="SheetName : string" />
    </Dynamo.Nodes.Symbol>
    <Dynamo.Nodes.Symbol guid="e6ad08c6-e3a0-4242-b53c-3e88c1f41a23" type="Dynamo.Nodes.Symbol" nickname="Input" x="-7.03592840662418" y="302.345309468875" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="True">
      <Symbol value="Index" />
    </Dynamo.Nodes.Symbol>
    <Dynamo.Nodes.Output guid="a8072f41-448b-4056-b3c6-30446790c778" type="Dynamo.Nodes.Output" nickname="Output" x="1996.50261803692" y="476.151246209579" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False">
      <Symbol value="IndexParameter" />
    </Dynamo.Nodes.Output>
    <Dynamo.Nodes.Output guid="e67c6d9c-c510-461c-a43c-9bc3e41502ae" type="Dynamo.Nodes.Output" nickname="Output" x="1985.6903498433" y="86.2347222944187" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False">
      <Symbol value="IndexValue" />
    </Dynamo.Nodes.Output>
    <Dynamo.Nodes.Output guid="8a989c08-0a37-48ff-9471-a727cb674ad0" type="Dynamo.Nodes.Output" nickname="Output" x="1998.44572595663" y="207.053040302633" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False">
      <Symbol value="IndexName" />
    </Dynamo.Nodes.Output>
    <Dynamo.Nodes.Output guid="41856b8e-49fc-4bd5-98cd-987e732fce40" type="Dynamo.Nodes.Output" nickname="Output" x="2230.0647782123" y="644.526668241934" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False">
      <Symbol value="ElementList" />
    </Dynamo.Nodes.Output>
    <Dynamo.Nodes.DSFunction guid="35c0129c-ecbc-4615-9379-759b6451f544" type="Dynamo.Nodes.DSFunction" nickname="String.Replace" x="1555.48398400538" y="592.130487470344" isVisible="true" isUpstreamVisible="true" lacing="Shortest" isSelectedInput="False" assembly="DSCoreNodes.dll" function="DSCore.String.Replace@string,string,string" />
    <DSCoreNodesUI.StringNodes.FromObject guid="d5698e83-d809-4bc6-999f-3f96c2f05f80" type="DSCoreNodesUI.StringNodes.FromObject" nickname="String from Object" x="1346.64566170398" y="577.993421359227" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" />
    <Dynamo.Nodes.CodeBlockNodeModel guid="cbdbe658-0117-4af4-9706-962e61ad0497" type="Dynamo.Nodes.CodeBlockNodeModel" nickname="Code Block" x="1347.36678183068" y="683.42588336244" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="True" CodeText="&quot;.000000&quot;;&#xA;&quot;&quot;;" ShouldFocus="false" />
    <Dynamo.Nodes.CodeBlockNodeModel guid="e8f04324-6bf5-4f80-a2ee-d54ffd5edb4a" type="Dynamo.Nodes.CodeBlockNodeModel" nickname="Code Block" x="1338.61364799793" y="118.138028129616" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="True" CodeText="&quot;&quot;;" ShouldFocus="false" />
    <Dynamo.Nodes.DSFunction guid="27b488f8-ee99-42a4-bd38-9d80558c78ae" type="Dynamo.Nodes.DSFunction" nickname="Object.IsNull" x="1392.92891835646" y="199.975323443856" isVisible="true" isUpstreamVisible="true" lacing="Shortest" isSelectedInput="False" assembly="DSCoreNodes.dll" function="DSCore.Object.IsNull@var" />
    <DSCore.Replace guid="fc6d1ed3-4ef2-4805-9ba8-69c6046ab629" type="DSCore.Replace" nickname="ReplaceByCondition" x="1538.68513140209" y="95.553834809075" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" />
    <PythonNodeModels.PythonNode guid="e0b6f90b-df8c-4b60-8ce1-a03a9559387f" type="PythonNodeModels.PythonNode" nickname="Id to Element" x="2007.93751406087" y="645.015305508634" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" inputcount="2">
      <Script>#Copyright(c) 2015, Konrad Sobon
# @arch_laboratory, http://archi-lab.net

import clr
clr.AddReference('ProtoGeometry')
from Autodesk.DesignScript.Geometry import *

# Import ToDSType(bool) extension method
clr.AddReference("RevitNodes")
import Revit
clr.ImportExtensions(Revit.Elements)

# Import DocumentManager and TransactionManager
clr.AddReference("RevitServices")
import RevitServices
from RevitServices.Persistence import DocumentManager
from RevitServices.Transactions import TransactionManager

from System.Collections.Generic import *

# Import RevitAPI
clr.AddReference("RevitAPI")
import Autodesk
from Autodesk.Revit.DB import *

doc = DocumentManager.Instance.CurrentDBDocument
uiapp = DocumentManager.Instance.CurrentUIApplication
app = uiapp.Application

#The inputs to this node will be stored as a list in the IN variable.
dataEnteringNode = IN
doc = IN[1]

def toRvtId(_id):
	if isinstance(_id, int) or isinstance(_id, str):
		id = ElementId(int(_id))
		return id
	elif isinstance(_id, ElementId):
		return _id

#unwrap incoming information for use with API
ids = []
for i in IN[0]:
    ids.append(UnwrapElement(i))

#use element ids to select elements
elements = []
message = None
try:
	for i in ids:
		elements.append(doc.GetElement(toRvtId(i)).ToDSType(True))
except:
	message = "Invalid Id"
	pass

#Assign your output to the OUT variable
if message != None:
	OUT =  '\n'.join('{:^35}'.format(s) for s in message.split('\n'))
else:
	OUT = elements</Script>
    </PythonNodeModels.PythonNode>
    <Dynamo.Nodes.CodeBlockNodeModel guid="3469736a-8e67-4665-97d8-fae64b66dbee" type="Dynamo.Nodes.CodeBlockNodeModel" nickname="Code Block" x="1770.90707028589" y="648.395825155377" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" CodeText="Flatten({list});" ShouldFocus="false" />
    <PythonNodeModels.PythonNode guid="868e1c4b-5b55-4f14-8dc3-a7bc40a951a8" type="PythonNodeModels.PythonNode" nickname="Python Script" x="1863.35971911724" y="714.342201084965" isVisible="true" isUpstreamVisible="true" lacing="Disabled" isSelectedInput="False" inputcount="0">
      <Script># Copyright(c) 2015, Konrad K Sobon
# @arch_laboratory, http://archi-lab.net

# Import DocumentManager
import clr
clr.AddReference("RevitServices")
import RevitServices
from RevitServices.Persistence import DocumentManager

import sys
pyt_path = r'C:\Program Files (x86)\IronPython 2.7\Lib'
sys.path.append(pyt_path)

#The inputs to this node will be stored as a list in the IN variable.
dataEnteringNode = IN

try:
	errorReport = None
	doc = DocumentManager.Instance.CurrentDBDocument
except:
	# if error accurs anywhere in the process catch it
	import traceback
	errorReport = traceback.format_exc()

#Assign your output to the OUT variable
if errorReport == None:
	OUT = doc
else:
	OUT = errorReport</Script>
    </PythonNodeModels.PythonNode>
  </Elements>
  <Connectors>
    <Dynamo.Models.ConnectorModel start="c71f7058-9a4b-49fd-b824-bed5c23577ea" start_index="0" end="9d617795-60c0-448f-86be-766a1ac71481" end_index="0" portType="0" />
    <Dynamo.Models.ConnectorModel start="9d617795-60c0-448f-86be-766a1ac71481" start_index="0" end="05fb3aa1-be34-459f-8383-79013ba66ac2" end_index="0" portType="0" />
    <Dynamo.Models.ConnectorModel start="05fb3aa1-be34-459f-8383-79013ba66ac2" start_index="0" end="41595262-82b1-400a-adab-b53c8102c661" end_index="0" portType="0" />
    <Dynamo.Models.ConnectorModel start="05fb3aa1-be34-459f-8383-79013ba66ac2" start_index="0" end="13b920c3-9746-41c4-b84a-ecaafa3c3332" end_index="0" portType="0" />
    <Dynamo.Models.ConnectorModel start="05fb3aa1-be34-459f-8383-79013ba66ac2" start_index="0" end="ccb441ab-1cb9-457b-bfd7-803017949fbb" end_index="0" portType="0" />
    <Dynamo.Models.ConnectorModel start="ccb441ab-1cb9-457b-bfd7-803017949fbb" start_index="2" end="ccee52ca-1001-4add-a0b7-23d7554e2c83" end_index="1" portType="0" />
    <Dynamo.Models.ConnectorModel start="ccb441ab-1cb9-457b-bfd7-803017949fbb" start_index="3" end="cd08c8d3-50c9-4b4f-afa0-5f896c0e5956" end_index="1" portType="0" />
    <Dynamo.Models.ConnectorModel start="ccee52ca-1001-4add-a0b7-23d7554e2c83" start_index="0" end="41595262-82b1-400a-adab-b53c8102c661" end_index="1" portType="0" />
    <Dynamo.Models.ConnectorModel start="cd08c8d3-50c9-4b4f-afa0-5f896c0e5956" start_index="0" end="13b920c3-9746-41c4-b84a-ecaafa3c3332" end_index="1" portType="0" />
    <Dynamo.Models.ConnectorModel start="41595262-82b1-400a-adab-b53c8102c661" start_index="0" end="c89f3ab7-274a-49b1-af29-093110eee13f" end_index="0" portType="0" />
    <Dynamo.Models.ConnectorModel start="41595262-82b1-400a-adab-b53c8102c661" start_index="0" end="c89f3ab7-274a-49b1-af29-093110eee13f" end_index="3" portType="0" />
    <Dynamo.Models.ConnectorModel start="13b920c3-9746-41c4-b84a-ecaafa3c3332" start_index="0" end="c89f3ab7-274a-49b1-af29-093110eee13f" end_index="2" portType="0" />
    <Dynamo.Models.ConnectorModel start="13b920c3-9746-41c4-b84a-ecaafa3c3332" start_index="0" end="a8072f41-448b-4056-b3c6-30446790c778" end_index="0" portType="0" />
    <Dynamo.Models.ConnectorModel start="c89f3ab7-274a-49b1-af29-093110eee13f" start_index="0" end="fc6d1ed3-4ef2-4805-9ba8-69c6046ab629" end_index="0" portType="0" />
    <Dynamo.Models.ConnectorModel start="c89f3ab7-274a-49b1-af29-093110eee13f" start_index="1" end="8a989c08-0a37-48ff-9471-a727cb674ad0" end_index="0" portType="0" />
    <Dynamo.Models.ConnectorModel start="c89f3ab7-274a-49b1-af29-093110eee13f" start_index="2" end="d5698e83-d809-4bc6-999f-3f96c2f05f80" end_index="0" portType="0" />
    <Dynamo.Models.ConnectorModel start="926481e9-ed90-41f3-a241-576c2f9e75f0" start_index="0" end="c71f7058-9a4b-49fd-b824-bed5c23577ea" end_index="0" portType="0" />
    <Dynamo.Models.ConnectorModel start="751d6164-8b6f-4f23-b6d2-84b1fc0e2ec3" start_index="0" end="9d617795-60c0-448f-86be-766a1ac71481" end_index="1" portType="0" />
    <Dynamo.Models.ConnectorModel start="e6ad08c6-e3a0-4242-b53c-3e88c1f41a23" start_index="0" end="c89f3ab7-274a-49b1-af29-093110eee13f" end_index="1" portType="0" />
    <Dynamo.Models.ConnectorModel start="35c0129c-ecbc-4615-9379-759b6451f544" start_index="0" end="3469736a-8e67-4665-97d8-fae64b66dbee" end_index="0" portType="0" />
    <Dynamo.Models.ConnectorModel start="d5698e83-d809-4bc6-999f-3f96c2f05f80" start_index="0" end="35c0129c-ecbc-4615-9379-759b6451f544" end_index="0" portType="0" />
    <Dynamo.Models.ConnectorModel start="cbdbe658-0117-4af4-9706-962e61ad0497" start_index="0" end="35c0129c-ecbc-4615-9379-759b6451f544" end_index="1" portType="0" />
    <Dynamo.Models.ConnectorModel start="cbdbe658-0117-4af4-9706-962e61ad0497" start_index="1" end="35c0129c-ecbc-4615-9379-759b6451f544" end_index="2" portType="0" />
    <Dynamo.Models.ConnectorModel start="e8f04324-6bf5-4f80-a2ee-d54ffd5edb4a" start_index="0" end="fc6d1ed3-4ef2-4805-9ba8-69c6046ab629" end_index="1" portType="0" />
    <Dynamo.Models.ConnectorModel start="27b488f8-ee99-42a4-bd38-9d80558c78ae" start_index="0" end="fc6d1ed3-4ef2-4805-9ba8-69c6046ab629" end_index="2" portType="0" />
    <Dynamo.Models.ConnectorModel start="fc6d1ed3-4ef2-4805-9ba8-69c6046ab629" start_index="0" end="e67c6d9c-c510-461c-a43c-9bc3e41502ae" end_index="0" portType="0" />
    <Dynamo.Models.ConnectorModel start="e0b6f90b-df8c-4b60-8ce1-a03a9559387f" start_index="0" end="41856b8e-49fc-4bd5-98cd-987e732fce40" end_index="0" portType="0" />
    <Dynamo.Models.ConnectorModel start="3469736a-8e67-4665-97d8-fae64b66dbee" start_index="0" end="e0b6f90b-df8c-4b60-8ce1-a03a9559387f" end_index="0" portType="0" />
    <Dynamo.Models.ConnectorModel start="868e1c4b-5b55-4f14-8dc3-a7bc40a951a8" start_index="0" end="e0b6f90b-df8c-4b60-8ce1-a03a9559387f" end_index="1" portType="0" />
  </Connectors>
  <Notes />
  <Annotations>
    <Dynamo.Models.AnnotationModel guid="77a34496-9e80-4d31-ad45-c02a096c9365" annotationText="# Copyright(c) 2015, Konrad K Sobon&#xD;&#xA;# @arch_laboratory, http://archi-lab.net" left="1760.90707028589" top="601.015305508634" width="381.03044377498" height="181.326895576331" fontSize="14" InitialTop="645.015305508634" InitialHeight="167.326895576331" TextblockHeight="34" backgrouund="#FFC1D676">
      <Models ModelGuid="e0b6f90b-df8c-4b60-8ce1-a03a9559387f" />
      <Models ModelGuid="3469736a-8e67-4665-97d8-fae64b66dbee" />
      <Models ModelGuid="868e1c4b-5b55-4f14-8dc3-a7bc40a951a8" />
    </Dynamo.Models.AnnotationModel>
  </Annotations>
  <Presets />
  <Cameras>
    <Camera Name="Background Preview" eyeX="-17" eyeY="24" eyeZ="50" lookX="12" lookY="-13" lookZ="-58" upX="0" upY="1" upZ="0" />
  </Cameras>
</Workspace>